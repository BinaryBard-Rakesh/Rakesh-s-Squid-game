function playGame() {
    let userGuess = parseInt(document.getElementById("guess").value);
    let randomNumber = Math.floor(Math.random() * 11);
    let pay = 0;
    let result = "";

    if (userGuess < 0 || userGuess > 10 || isNaN(userGuess)) {
        result = "Please enter a valid number between 0 and 10.";
    } else {
        gamesPlayed++;

        if (userGuess === randomNumber) {
            wins++;
            pay = (losses - wins) * 100;
            if (pay < 0) pay = 0;
            result = "You win!<br>" +
                     "You have to pay " + pay + " rupees to treat me.";
        } else {
            losses++;
            pay = (losses - wins) * 100;
            result = "You lose!<br>" +
                     "The number was: " + randomNumber + "<br>" +
                     "You owe me a treat worth at least 100 rupees.<br>" +
                     "You have to pay " + pay + " rupees to treat me.<br>" +
                     "Please text me the restaurant name, place, and time.<br>" +
                     "Better luck next time.";
        }
    }

    document.getElementById("result").innerHTML = result;
    updateStats();
    saveResults();
}

function saveResults() {
    if (!playerName) return; // Prevent sending empty data

    let data = {
        name: playerName,
        gamesPlayed: gamesPlayed,
        wins: wins,
        losses: losses,
        pay: (losses - wins) * 100
    };

    fetch("https://script.google.com/macros/s/AKfycbx99RP4ZKOt-jmt-Kx8rpsJcZv6oEyAXOPzmpOR87YV-b2Zzy8X5NoGastJSeFF_74/exec", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
    });
}
